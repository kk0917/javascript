<!DOCTYPE html>
<html xml:lang="ja" lang="ja">
<head>
<meta charset="utf-8">
<meta name="robots" content="noindex,nofollow"/>
<title>JavaScript TechnicalNote － SAMPLE</title>
<link rel="stylesheet" href="../../common/css/common.css">
<link rel="stylesheet" href="../../common/css/chapterlist.css">
<style>
/* Design */
.baseHeader {
	background: none;
}
.baseFooter {
	bottom: 0;
	border-top: none;
	position: relative;
}
.baseFooter small {
	color: #fff;
}
/* layout */
#fullScreen {
  top: 0;
  left: 0;
  width: 100%;
  position: fixed;
  z-index: 0;
  visibility: hidden;
}
#fullScreen img {
	top: 50%;
	left: 50%;
	position: absolute;
	visibility: hidden;
}
#wrapper {
	margin: 15px auto;
	padding: 50px;
	width: 800px;
	color: #fff;
	text-align: left;
	position: relative;
	box-sizing: border-box;
	background-color: rgba(0,0,0,0.4)
}

p {
	padding-bottom: 2em;
	font-size: 1em;
	line-height: 1.8em;
	text-align: left;
}
</style>
</head>

<body>

<header class="baseHeader">
<div>
<h1>jQuery TECHNIQUE</h1>
<a href="../../chapterList.html">&gt;&nbsp;CHAPTER LIST</a>
</div>
</header>

<h2 id="title">背景画像をフルスクリーンサイズで表示する（2）</h2>

<div id="wrapper">

<p>窓の外の、まるで花火でいっぱいのような、あまの川のまん中に、黒い大きな建物が四棟ばかり立って、その一つの平屋根の上に、眼もさめるような、青宝玉と黄玉の大きな二つのすきとおった球が、輪になってしずかにくるくるとまわっていました。黄いろのがだんだん向うへまわって行って、青い小さいのがこっちへ進んで来、間もなく二つのはじは、重なり合って、きれいな緑いろの両面凸レンズのかたちをつくり、それもだんだん、まん中がふくらみ出して、とうとう青いのは、すっかりトパースの正面に来ましたので、緑の中心と黄いろな明るい環とができました。それがまただんだん横へ外れて、前のレンズの形を逆に繰り返し、とうとうすっとはなれて、サファイアは向うへめぐり、黄いろのはこっちへ進み、また丁度さっきのような風になりました。銀河の、かたちもなく音もない水にかこまれて、ほんとうにその黒い測候所が、睡っているように、しずかによこたわったのです。</p>

<p>「あれは、水の速さをはかる器械です。水も……。」鳥捕りが云いかけたとき、「切符を拝見いたします。」三人の席の横に、赤い帽子をかぶったせいの高い車掌が、いつかまっすぐに立っていて云いました。鳥捕りは、だまってかくしから、小さな紙きれを出しました。車掌はちょっと見て、すぐ眼をそらして、（あなた方のは？）というように、指をうごかしながら、手をジョバンニたちの方へ出しました。</p>

<p>「さあ、」ジョバンニは困って、もじもじしていましたら、カムパネルラは、わけもないという風で、小さな鼠いろの切符を出しました。ジョバンニは、すっかりあわててしまって、もしか上着のポケットにでも、入っていたかとおもいながら、手を入れて見ましたら、何か大きな畳んだ紙きれにあたりました。こんなもの入っていたろうかと思って、急いで出してみましたら、それは四つに折ったはがきぐらいの大きさの緑いろの紙でした。車掌が手を出しているもんですから何でも構わない、やっちまえと思って渡しましたら、車掌はまっすぐに立ち直って叮寧にそれを開いて見ていました。そして読みながら上着のぼたんやなんかしきりに直したりしていましたし燈台看守も下からそれを熱心にのぞいていましたから、ジョバンニはたしかにあれは証明書か何かだったと考えて少し胸が熱くなるような気がしました。</p>

<p>「これは三次空間の方からお持ちになったのですか。」車掌がたずねました。「何だかわかりません。」もう大丈夫だと安心しながらジョバンニはそっちを見あげてくつくつ笑いました。「よろしゅうございます。南十字へ着きますのは、次の第三時ころになります。」車掌は紙をジョバンニに渡して向うへ行きました。</p>

<p>カムパネルラは、その紙切れが何だったか待ち兼ねたというように急いでのぞきこみました。ジョバンニも全く早く見たかったのです。ところがそれはいちめん黒い唐草のような模様の中に、おかしな十ばかりの字を印刷したものでだまって見ていると何だかその中へ吸い込まれてしまうような気がするのでした。すると鳥捕りが横からちらっとそれを見てあわてたように云いました。「おや、こいつは大したもんですぜ。こいつはもう、ほんとうの天上へさえ行ける切符だ。天上どこじゃない、どこでも勝手にあるける通行券です。こいつをお持ちになれぁ、なるほど、こんな不完全な幻想第四次の銀河鉄道なんか、どこまででも行ける筈でさあ、あなた方大したもんですね。」「何だかわかりません。」ジョバンニが赤くなって答えながらそれを又畳んでかくしに入れました。そしてきまりが悪いのでカムパネルラと二人、また窓の外をながめていましたが、その鳥捕りの時々大したもんだというようにちらちらこっちを見ているのがぼんやりわかりました。「もうじき鷲の停車場だよ。」カムパネルラが向う岸の、三つならんだ小さな青じろい三角標と地図とを見較べて云いました。</p>

</div><!-- /#wrapper -->

<footer class="baseFooter">
<small>Copyright &copy; kkkk. All Rights Reserved.</small>
</footer>

<script src="../jquery-1.12.4.min.js"></script>
<script src="../../common/js/chapterlist.js"></script>
<script>
$( "body" ).prepend(
	"<div id='fullScreen'>"
	+ "<img src='./img/element008/photo1.jpg'>"
	+ "<img src='./img/element008/photo2.jpg'>"
	+ "<img src='./img/element008/photo3.jpg'>"
	+ "<img src='./img/element008/photo4.jpg'>"
	+ "<img src='./img/element008/photo5.jpg'>"
	+ "</div>"
);

$( window ).on("load", function() {
  var fullScreen  = $( "#fullScreen" );
	var fullImg     = fullScreen.children("img");
  var fadeSpeed   = 1000;
	var switchDelay = 5000;
	// 背景画像の縦横比
  var imgRatio    = fullImg.width() / fullImg.height();

	// ウィンドウサイズと画像サイズを取得してフルスクリーンで配置する
  function imgFit() {
    var wdWidth  = $( window ).width();
    var wdHeight = $( window ).height();
		// 現在のウィンドウ幅を画像の幅と同じにした際の画像の高さ
		setHeight    = wdWidth / imgRatio;

		if (setHeight < wdHeight) {
			setHeight = $( window ).height();
			wdWidth   = setHeight * imgRatio;
		}

		// 背景画像をウィンドウの中央にフルスクリーンで表示するためのCSSを画像に設定
		// 画像を囲むブロック要素の高さをウィンドウの高さと合わせる
		fullScreen.css({height:wdHeight});
		fullImg.css({
			marginTop:Math.round(-setHeight / 2),
			marginLeft:Math.round(-wdWidth / 2),
			width:wdWidth,
			height:setHeight
		});
  }

	// ウィンドウのリサイズ時とページロード時に一度実行
	$( window ).on("resize", function() { imgFit(); });
	imgFit();

	// 配置した中の1番先頭に位置する画像のみ表示される
	fullImg.css({
		visibility:"visible",
		opacity:"0",
	}).first().animate({opacity:"1"}, fadeSpeed);

	// 表示する画像の切り替え処理 
	setInterval(function() {
		// 一枚目の画像を変数に格納し、フェードイン表示
		var firstImg = fullScreen.find( "img:first" );
		// 一枚目の画像をフェードアウトし、次の兄弟要素の画像をフェードイン表示
		firstImg.animate( {opacity:"0"}, fadeSpeed )
			.next()
				.animate( {opacity:"1"}, fadeSpeed )
				// 一枚目の画像に戻って、画像ブロック要素の最後に画像を移動
				.end()
			.appendTo(fullScreen);
	}, switchDelay);
});

///////////////////////////////////////////////////////////////////////////////////////////////
// jQuery -> JavaScript

// (function () {
// 	// create background images and setting them
// 	var div = document.createElement('div');
// 	div.setAttribute('id', 'fullScreen');
// 	div.innerHTML = 
// 		'<img src="./img/element008/photo1.jpg">'
// 	+ '<img src="./img/element008/photo2.jpg">'
// 	+ '<img src="./img/element008/photo3.jpg">'
// 	+ '<img src="./img/element008/photo4.jpg">'
// 	+ '<img src="./img/element008/photo5.jpg">';

// 	document.body.insertBefore(div, document.body.firstChild);

// 	// setting the details of background images
// 	window.onload = function () {
// 		var fullScreen       = document.getElementById('fullScreen');
// 		var backgroundImages = fullScreen.querySelectorAll('img');

// 		// aspect ratio of background image
// 		var imageRatio = backgroundImages[0].width / backgroundImages[0].height;

// 		// execute the function when this page load and resize
// 		setBackgroundImages();
// 		window.addEventListener('resize', function() { setBackgroundImages() }, false);

// 		// show only the first image
// 		backgroundImages[0].style.visibility = 'visible';
// 		backgroundImages.forEach(function (image, index) {
// 			image.style.visibility = 'visible';
// 			image.style.opacity    = index === 0 ? 1 : 0;
// 		});
// 			// TODO: add fade animation...
		
// 		// change the image to other one
// 		setInterval(function () {
// 			var firstImage = fullScreen.querySelector('img:nth-child(1)');
// 			firstImage.style.opacity = 0;
// 			firstImage.nextElementSibling.style.opacity = 1;
// 			fullScreen.appendChild(firstImage);
// 			// TODO: add fade animation...
// 		}, 5000);

// 		/**
// 		 * get window size and image one -> set full screen
// 		 */
// 		function setBackgroundImages() {
// 			var windowWidth  = window.innerWidth;
// 			var windowHeight = window.innerHeight;

// 			// image height in the case of making the width of current window equal image one
// 			var setHeight = windowWidth / imageRatio;

// 			if (setHeight < windowHeight) {
// 				setHeight = window.innerHeight;
// 				wdWidth   = setHeight * imageRatio;
// 			}

// 			fullScreen.style.height = windowHeight + 'px';
// 			backgroundImages.forEach(function (image) {
// 				image.style.marginTop  = Math.round(-setHeight / 2) + 'px';
// 				image.style.marginLeft = Math.round(-windowWidth / 2) + 'px';
// 				image.style.width      = windowWidth + 'px';
// 				image.style.height     = setHeight + 'px';
// 			});
// 		}
// 	};
// })();
</script>
</body>
</html>
